{% load compress %} {% load static %} {% load my_filters %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>
      {% block title %} Timber - A personal Blogging website {% endblock %}
    </title>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://cdn.tiny.cloud/1/j716momly6yl5d5lv88gif4ac4gzjhzimtp1x8jwz8xj38ba/tinymce/7/tinymce.min.js" referrerpolicy="origin"></script>
    <meta
      name="google-signin-client_id"
      content="55543214080-93k2v44h75tp0p6l3h55lh0qhs6bgdem.apps.googleusercontent.com"
    />
    <link rel="icon" href="{% static '/fav1.png' %}" />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&amp;display=swap"
      rel="stylesheet"
    />
     <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
      rel="stylesheet"
    />
    {% compress css %}
    <link rel="stylesheet" href="{% static 'src/output.css' %}" />
    {% endcompress %}
  </head>
  <body class="font bg-blue-950 scrollbar-thin ">
    <div class="container min-h-screen mx-auto relative  bg-repeat" 
    {% if not request.user.is_authenticated %} style="background-image: url('{% static 'icons-gray-bg.svg' %}') !important;" {% endif %}>
      <!--Left Sidebar -->
      {% if request.user.is_authenticated %}
      <div class="hidden xl:flex bg-white flex-col rounded-lg shadow-md justify-between items-center w-64 border-r border-gray-500 fixed top-0 min-h-screen">
        <div class="flex text-blue-900 flex-col items-center w-full mt-6 ">
          <div
            onclick="homeRedirect()"
            class="w-[150px] sm:w-[180px] btn-hover transition-transform duration-300 mb-8">
            <img src="{% static '/timber.png' %}" />
          </div>
          <div onclick="homeRedirect()" class="flex transition-colors items-center text-xl {% if sidebar_active_home %} bg-gray-200 {% endif %} hover:bg-gray-200 p-2 w-full hoverable">
            <i class="fas fa-home mr-2"> </i>
            <span class="flex-1"> Home </span>
          </div>
          <div onclick="RedirectToDashboard()" class="flex transition-colors items-center text-xl {% if sidebar_active_dashboard %} bg-gray-200 {% endif %} hover:bg-gray-200 p-2 w-full hoverable">
            <i class="fas fa-tachometer-alt mr-2"> </i>
            <span class="flex-1"> Dashboard </span>
          </div>
          <a href="{% url 'user_activity' %}" class="flex transition-colors items-center text-xl {% if sidebar_active_activity %} bg-gray-200 {% endif %} hover:bg-gray-200 p-2 w-full">
            <i class="fas fa-bolt mr-2"> </i>
            <span class="flex-1"> Activity </span>
          </a>
          <a href="{% url 'notifications' %}" class="flex transition-colors relative items-center text-xl hover:bg-gray-200 p-2 w-full {% if sidebar_active_notifications %} bg-gray-200 {% endif %}">
            <i class="fas fa-bell mr-2"> </i>
            <span class="flex-1"> Notifications </span>
            {% if unread_count > 0 %}
            <span class="w-[10px] h-[10px] absolute top-2 left-4 bg-red-600 rounded-full "> </span>
            <span class="px-2 py-1 text-xs font-bold text-red-100 bg-red-600 rounded-full">{{ unread_count }}</span>
            {% endif %}
          </a>
          <div class="flex flex-col w-full">
            <div
              class="flex items-center transition-colors hover:bg-gray-200 p-2 w-full hoverable border-b text-xl"
              id="accountDiv"
              onclick="toggleDropdown()"
            >
              <i class="fas fa-user mr-2"> </i>
              <span class="flex-1"> Account </span>
              <i class="fas fa-chevron-down" id="accountArrow"> </i>
            </div>
            <div
              class="flex flex-col w-full overflow-hidden max-h-0 transition-[max-height] duration-500 ease-in-out bg-gray-200"
              id="accountDropdown">
              <a href="{% url 'posts' request.user.username %}" class="flex items-center transition-colors p-2 hover:bg-gray-300 {% if sidebar_active_user_post %} bg-gray-300 {% endif %}">
                <span class="flex-1"> All Posts </span>
                <span> {{ request.user.posts.count }} </span>
              </a>
              <a href="{% url 'followers' request.user.username %}" id="followers-bar" class="flex items-center transition-colors p-2 hover:bg-gray-300 {% if sidebar_active_user_follower %} bg-gray-300 {% endif %}">
                <span class="flex-1"> Followers </span>
                <span> {{ request.user.followers.count }} </span>
              </a>
              <a href="{% url 'followings' request.user.username %}" id="followings-bar" class="flex transition-colors items-center p-2 hover:bg-gray-300 {% if sidebar_active_user_following %} bg-gray-300 {% endif %}">
                <span class="flex-1"> Followings </span>
                <span> {{ request.user.following.count }} </span>
              </a>
                <div onclick="showLogoutModal()" class="flex transition-colors justify-start items-center p-2 hover:bg-gray-300 hoverable">
                  <span class="flex-1"> Logout </span>
                  <i class="fas fa-right-from-bracket"></i>
                </div>
              <a href="{% url 'user_profile' request.user.username %}">
                <div class="flex items-center transition-colors p-2 {% if sidebar_active_user %} bg-gray-300 {% endif %} hover:bg-gray-300">
                  {% if request.user.profile_picture %}
                  <img
                    alt="{{ request.user.profile_picture }}'s image"
                    class="rounded-full mr-2 h-10 w-10"
                    src="{{ request.user.profile_picture.url }}"
                    width="40"
                    height="40"
                  />
                  {% else %}
                  <img
                    alt="Profile Picture"
                    class="rounded-full mr-2 h-10 w-10"
                    src="{% static '/no-profile-pic.png' %}"
                    width="40"
                    height="40"
                  />
                  {% endif %}
                  <div>
                    <div class="font-bold">
                      {% if request.user.first_name and request.user.first_name %}
                      {{ request.user.first_name }} {{ request.user.last_name }}
                      {% else %}
                      {{ request.user.username|remove_special_chars }}
                      {% endif %}
                    </div>
                    <div class="text-sm underline">@{{ request.user.username }}</div>
                  </div>
                </div>
              </a>
            </div>
          </div>
          <a href="{% url 'settings' %}" class="flex transition-colors items-center text-lg hover:bg-gray-200 p-2 w-full {% if sidebar_active_settings %} bg-gray-200 {% endif %}">
            <i class="fas fa-cog mr-2"> </i>
            <span class="flex-1"> Settings </span>
          </a>
        </div>
        <div
          onclick="create_post_URL()"
          class="flex items-center space-x-2 text-lg bg-blue-500 text-white py-2 px-4 rounded-full w-10/12 justify-center hover:bg-blue-600 mx-4 mb-4 hoverable">
          <i class="fa-solid fa-pen-to-square"></i>
          <span> Create </span>
        </div>
      </div>
      <div class="flex xl:hidden max-[1023px]:hidden bg-white flex-col rounded-lg shadow-md justify-between items-center w-20 border-r border-gray-500 fixed top-0 min-h-screen">
        <div class="flex text-2xl text-blue-900 flex-col items-center space-y-3">
          <div
            onclick="homeRedirect()"
            class="w-[75px] btn-hover transition-transform duration-300 mb-8 cursor-pointer">
            <img class="rounded-xl mt-1" src="{% static '/fav1.png' %}" />
          </div>
          <div onclick="homeRedirect()" class="text-2xl flex items-center hover:bg-gray-200 p-2 w-full transition-colors hoverable pl-6 {% if sidebar_active_home %} bg-gray-200 {% endif %}">
            <i class="fas fa-home"> </i>
            {% comment %} <span class="flex-1"> Home </span> {% endcomment %}
          </div>
          <div onclick="RedirectToDashboard()" class="text-2xl flex transition-colors items-center hover:bg-gray-200 p-2 w-full hoverable pl-6 {% if sidebar_active_dashboard %} bg-gray-200 {% endif %}">
            <i class="fas fa-tachometer-alt mr-2"> </i>
            {% comment %} <span class="flex-1"> Dashboard </span> {% endcomment %}
          </div>
          <a href="{% url 'user_activity' %}" class="flex text-2xl {% if sidebar_active_activity %} bg-gray-200 {% endif %} items-center hover:bg-gray-200 p-2 w-full transition-colors pl-6">
            <i class="fas fa-bolt mr-2"> </i>
            {% comment %} <span class="flex-1"> Activity </span> {% endcomment %}
          </a>
          <a href="{% url 'notifications' %}" class="flex items-center hover:bg-gray-200 p-2 w-full text-2xl relative transition-colors pl-6 {% if sidebar_active_notifications %} bg-gray-200 {% endif %}">
            <i class="fas fa-bell mr-2"> </i>
            {% comment %} <span class="flex-1"> Notifications </span> {% endcomment %}
            {% if unread_count > 0 %}
            <span class="px-[2px] absolute top-0 right-8 text-xs text-red-100 bg-red-600 rounded-full">{{ unread_count }}</span>
            {% endif %}
          </a>
          <div class="flex flex-col w-full">
            <div
              class="flex items-center transition-colors hover:bg-gray-200 p-2 w-full hoverable border-b pl-6 text-2xl"
              id="accountDivMenu"
              onclick="toggleDropdownMenu()"
            >
              <i class="fas fa-user mr-2"> </i>
              <i class="fas fa-chevron-down text-sm" id="accountArrowMenu"> </i>
            </div>
            <div
              class="flex flex-col w-full bg-gray-200 overflow-hidden max-h-0 transition-[max-height] duration-500 ease-in-out"
              id="accountDropdownMenu"
            >
                <div onclick="showLogoutModal()" class="flex transition-colors items-center p-2 hover:bg-gray-300 hoverable pl-6">
                  <i class="fa-solid fa-right-from-bracket"></i>
                </div>
              <a href="{% url 'user_profile' request.user.username %}">
                <div class="flex items-center transition-colors pl-4 p-2 hover:bg-gray-300 {% if sidebar_active_user %} bg-gray-300 {% endif %}">
                  {% if request.user.profile_picture %}
                  <img
                    alt="{{ request.user.profile_picture }}'s image"
                    class="rounded-full mr-2 h-12 w-12"
                    src="{{ request.user.profile_picture.url }}"
                    width="40"
                    height="40"
                  />
                  {% else %}
                  <img
                    alt="Profile Picture"
                    class="rounded-full mr-2 h-10 w-10"
                    src="{% static '/no-profile-pic.png' %}"
                    width="40"
                    height="40"
                  />
                  {% endif %}
                  {% comment %} <div>
                    <div class="font-bold">
                      {{ request.user.first_name }} {{ request.user.last_name }}
                    </div>
                    <div class="text-sm">@{{ request.user.username }}</div>
                  </div> {% endcomment %}
                </div>
              </a>
            </div>
          </div>
          <a href="{% url 'settings' %}" class="flex transition-colors items-center text-2xl hover:bg-gray-200 p-2 w-full {% if sidebar_active_settings %} bg-gray-200 {% endif %} pl-6">
            <i class="fas fa-cog mr-2"> </i>
            {% comment %} <span class="flex-1"> Settings </span> {% endcomment %}
          </a>
        </div>
        <div
          onclick="create_post_URL()"
          class="flex items-center space-x-2 bg-blue-500 text-white py-6 px-4 rounded-full w-10/12 justify-center hover:bg-blue-600 mx-4 mb-4 hoverable text-[22px]">
          <i class="fa-solid fa-pen-to-square"></i>
          {% comment %} <span> Create </span> {% endcomment %}
        </div>
      </div>
      {% endif %}
      {% block content %} {% endblock content %}
       <!-- Right Sidebar -->
      {% if request.user.is_authenticated %}
      <div class="flex max-[1023px]:hidden bg-white flex-col rounded-lg shadow-md justify-between xl:w-80 w-72 border-l border-gray-500 fixed min-[1537px]:right-[512px] max-[1535px]:right-[80px] max-[1280px]:right-0 right-0 top-0 min-h-screen">
       <div class="flex text-blue-900 flex-col items-center w-full mt-6">
        <div class="relative w-full px-4">
         <i class="fas fa-search absolute left-7 top-3 text-blue-900">
         </i>
         <input id="search-input" class="w-full p-2 pl-9 bg-gray-200 text-blue-900 focus:outline-none focus:ring-4 focus:ring-blue-400 rounded-2xl" placeholder="Search" type="text"/>
         <div id="search-results" class="hidden absolute z-10 w-[94%] left-[10px] bg-white rounded-lg border border-blue-600 h-[80vh] overflow-x-auto scrollbar-thin">
         </div>
        </div>
        <div class="text-xl font-bold mb-4 mt-10 w-full text-center border-b">
         Recommended Blogs
        </div>
        <div id="RandomUsersContainer" class="flex  flex-col w-full space-y-4 min-h-[calc(100vh-250px)]">
         {% if random_users %}
         {% for user, is_following in user_following %}
         <div class="flex items-center justify-between hover:bg-gray-200 p-2 w-full hoverable">
          <a href="{% url 'user_profile' user.username %}" class="flex items-center">
            {% if user.profile_picture %}
            <img
              alt="{{ user.profile_picture }}'s image"
              class="rounded-full mr-2 h-10 w-10"
              src="{{ user.profile_picture.url }}"
              width="40"
              height="40"
            />
            {% else %}
            <img
              alt="Profile Picture"
              class="rounded-full mr-2 h-10 w-10"
              src="{% static '/no-profile-pic.png' %}"
              width="40"
              height="40"
            />
            {% endif %}
           <div class="w-[72%]">
            <div class="font-bold tabButton">
              {% if user.first_name and user.last_name %}
              {{ user.first_name }} {{ user.last_name }}
              {% else %}
              {{ user.username|remove_special_chars }}
              {% endif %}
            </div>
            <div class="text-sm underline tabButton">
              @{{ user.username }}
            </div>
           </div>
          </a>
          {% if is_following %}
          <button onclick="followUnfollow(this, '{{ user.username }}')" class="bg-blue-500 follow-button-{{ user.username }} text-white py-1 px-3 rounded-full hover:bg-blue-600 space-x-1 tabButton">
            <i class="fas fa-user-check"></i>
           <span>Following</span>
          </button>
          {% else %}
          <button onclick="followUnfollow(this, '{{ user.username }}')" class="bg-blue-500 follow-button-{{ user.username }} text-white py-1 px-3 rounded-full hover:bg-blue-600 space-x-1">
            <i class="fas fa-user-plus"></i>
           <span>Follow</span>
          </button>
          {% endif %}
         </div>
         {% endfor %}
         {% else %}
         {% comment %} No Recommended blogs found {% endcomment %}
         <div class="text-center text-blue-700 hover:text-blue-400 border-2 border-blue-700 w-[90%] hover:border-blue-400 rounded-2xl p-2 mx-auto">
            No Recommended blogs found
          </div>
          {% endif %}
         {% if random_users_count > 4%}
         <div class="p-2 w-full text-center">
          <butto onclick="refreshUsers()" class="bg-blue-900 w-[60%] text-white py-1 px-3 rounded-full hover:bg-blue-700 border-2 border-blue-400 btn-hover transition-transform duration-300 hoverable">
           Refresh
          </button>
         </div>
          {% endif %}
        </div>
       </div>
       <!-- Footer -->
       <div class="flex flex-col items-center w-full mt-6 mb-4">
        <div class="flex space-x-2 mb-2 text-sm">
         <div onclick="RedirectToUrl({% url 'privacy_policy' %})" class="hoverable hover:underline">
          Privacy Policy
         </div>
         <div onclick="RedirectToUrl({% url 'terms_and_conditions' %})" class="hoverable hover:underline">
          Terms and Conditions
         </div>
         <div onclick="RedirectToUrl({% url 'about_us' %})" class="hoverable hover:underline">
          About
         </div>
        </div>
        <div class="text-sm mt-1">
          &copy; {{ current_year }}
          <a class="hover:underline" href="{% url 'home' %}">Timber.</a> All
          rights reserved.
        </div>
       </div>
      </div>
      {% endif %}
    </div>
    <button
      id="scrollToTopBtn"
      class="hidden fixed bottom-[68px] right-5 bg-blue-500 text-white rounded-full p-4 shadow-lg hover:bg-blue-600 transition duration-300 px-5">
      <i class="fas fa-arrow-up"></i>
      <!-- Font Awesome icon -->
    </button>
     <!-- Modal -->
    <div id="loginModal" class="modal text-blue-900">
      <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2 class="text-2xl font-bold mb-4 font">Please Login</h2>
        <p class="text-lg mb-4">You need to login to perform this action.</p>
        {% comment %} <button
          class="bg-blue-900 text-white py-2 px-4 rounded-full hover:bg-blue-800 transition-transform duration-300"
          onclick="closeModal()">
          Close
        </button> {% endcomment %}
        <button
          class="bg-blue-900 text-white py-2 px-4 rounded-full hover:bg-blue-800 transition-transform duration-300"
          onclick="RedirectToUrl({% url 'login' %})"
        >
          Login
        </button>
      </div>
    </div>
    {% if request.user.is_authenticated %}
    <div id="sidebarModal" class="modal">
      <div id="sidebar" class="flex bg-white flex-col rounded-lg shadow-md justify-between items-center w-[90%] max-w-[360px] border-r border-gray-500 fixed top-0 min-h-screen transition-transform duration-200 ease-in-out hide"> 
        <div class="flex text-blue-900 flex-col items-center w-full mt-6 ">
          <div class="flex justify-between items-center w-full px-4 mb-8">
            <div onclick="homeRedirect()"
              class="w-[150px] sm:w-[180px] btn-hover transition-transform duration-300">
              <img src="{% static '/timber.png' %}" />
            </div>
            <div onclick="hideSidebarModel()" class="hoverable mr-1">
              <i class="fa-solid fa-xmark text-3xl hover:text-blue-600 btn-hover transition-transform duration-300"></i>
            </div>
          </div>
          <div onclick="homeRedirect()" class="flex items-center hover:bg-gray-200 transition-colors text-xl p-2 w-full hoverable {% if sidebar_active_home %} bg-gray-200 {% endif %}">
            <i class="fas fa-home mr-2"> </i>
            <span class="flex-1"> Home </span>
          </div>
          <div onclick="RedirectToDashboard()" class="flex transition-colors items-center text-xl {% if sidebar_active_dashboard %} bg-gray-200 {% endif %} hover:bg-gray-200 p-2 w-full hoverable">
            <i class="fas fa-tachometer-alt mr-2"> </i>
            <span class="flex-1"> Dashboard </span>
          </div>
          <a href="{% url 'user_activity' %}" class="flex transition-colors items-center text-xl hover:bg-gray-200 p-2 w-full {% if sidebar_active_activity %} bg-gray-200 {% endif %}">
            <i class="fas fa-bolt mr-2"> </i>
            <span class="flex-1"> Activity </span>
          </a>
          <a href="{% url 'notifications' %}" class="flex transition-colors relative text-xl items-center hover:bg-gray-200 p-2 w-full hoverable {% if sidebar_active_notifications %} bg-gray-200 {% endif %}">
            <i class="fas fa-bell mr-2"> </i>
            <span class="flex-1"> Notifications </span>
            {% if unread_count > 0 %}
            <span class="w-[10px] h-[10px] absolute top-2 left-4 bg-red-600 rounded-full "> </span>
            <span class="px-2 py-1 text-xs font-bold text-red-100 bg-red-600 rounded-full">{{ unread_count }}</span>
            {% endif %}
          </a>
          <div class="flex flex-col w-full">
            <div
              class="flex text-xl items-center transition-colors hover:bg-gray-200 p-2 w-full hoverable border-b"
              id="accountDivSidebar"
              onclick="toggleDropdownSidebar()"
            >
              <i class="fas fa-user mr-2"> </i>
              <span class="flex-1"> Account </span>
              <i class="fas fa-chevron-down mr-1" id="accountArrowSidebar"> </i>
            </div>
            <div
              class="flex flex-col w-full bg-gray-200 overflow-hidden max-h-0 transition-[max-height] duration-500 ease-in-out"
              id="accountDropdownSidebar"
            >
              <a href="{% url 'posts' request.user.username %}" class="flex items-center transition-colors p-2 hover:bg-gray-300 {% if sidebar_active_user_post %} bg-gray-300 {% endif %}">
                <span class="flex-1"> All Posts </span>
                <span class="mr-1"> {{ request.user.posts.count }} </span>
              </a>
              <a href="{% url 'followers' request.user.username %}" class="flex items-center transition-colors p-2 hover:bg-gray-300 {% if sidebar_active_user_follower %} bg-gray-300 {% endif %}">
                <span class="flex-1"> Followers </span>
                <span class="mr-1"> {{ request.user.followers.count }} </span>
              </a>
              <a href="{% url 'followings' request.user.username %}" class="flex items-center transition-colors p-2 hover:bg-gray-300 {% if sidebar_active_user_following %} bg-gray-300 {% endif %}">
                <span class="flex-1"> Following </span>
                <span class="mr-1"> {{ request.user.following.count }} </span>
              </a>
              <div onclick="showLogoutModal()" class="flex transition-colors items-center p-2 hover:bg-gray-300 hoverable">
                <span class="flex-1"> Logout </span>
                <i class="fa-solid fa-right-from-bracket mr-1"></i>
              </div>
              <a href="{% url 'user_profile' request.user.username %}">
                <div class="flex transition-colors items-center p-2 hover:bg-gray-300 hoverable {% if sidebar_active_user %} bg-gray-300 {% endif %}">
                  {% if request.user.profile_picture %}
                  <img
                    alt="{{ request.user.profile_picture }}'s image"
                    class="rounded-full mr-2 h-10 w-10"
                    src="{{ request.user.profile_picture.url }}"
                    width="40"
                    height="40"
                  />
                  {% else %}
                  <img
                    alt="Profile Picture"
                    class="rounded-full mr-2 h-10 w-10"
                    src="{% static '/no-profile-pic.png' %}"
                    width="40"
                    height="40"
                  />
                  {% endif %}
                  <div>
                    <div class="font-bold">
                      {% if request.user.first_name and request.user.last_name %}
                      {{ request.user.first_name }} {{ request.user.last_name }}
                      {% else %}
                      {{ request.user.username|remove_special_chars }}
                      {% endif %}
                    </div>
                    <div class="text-sm underline">@{{ request.user.username }}</div>
                  </div>
                </div>
              </a>
            </div>
          </div>
          <a href="{% url 'settings' %}" class="flex transition-colors items-center text-xl hover:bg-gray-200 p-2 w-full {% if sidebar_active_settings %} bg-gray-200 {% endif %}">
            <i class="fas fa-cog mr-2"> </i>
            <span class="flex-1"> Settings </span>
          </a>
        </div>
        <div onclick="create_post_URL()" class="flex items-center space-x-2 bg-blue-500 text-white py-2 px-4 rounded-full w-10/12 justify-center hover:bg-blue-600 mx-4 mb-28 hoverable">
          <i class="fa-solid fa-pen-to-square"></i>
          <span> Create </span>
        </div>
      </div>
    </div>
    {% endif %}
     <!--Logout Modal -->
    <div id="logoutModal" class="modal text-blue-900">
      <div class="modal-content">
        <p class="text-xl mb-4">Are you sure you want to log out?</p>
        <div class="flex justify-center space-x-4">
          <button
            onclick="hideLogoutModal()"
            class="bg-blue-900 text-white py-2 px-4 rounded-full hover:bg-blue-800 transition-transform duration-300"
          >
            Cancel
          </button>
          <a href="{% url 'logout' %}">
          <button
            class="bg-blue-600 text-white py-2 px-4 rounded-full hover:bg-blue-500 transition-transform duration-300"
          >
            OK
          </button></a>
        </div>
      </div>
    </div>
    <!-- Full Image Popup Modal -->
    <div id="imageModal" class="modal">
      <div class="modal-content-image">
        <span class="close-image" onclick="closeImageModal()">&times;</span>
        <img class="modal-image rounded-xl border-2 " id="fullImage" />
      </div>
    </div>
    <!-- Delete Confirmation Modals -->
     <!--banner model-->
     <div class="fixed z-50 inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden" id="deleteBannerModal">
      <div class="bg-white rounded-lg shadow-md p-6 w-96">
       <h3 class="text-xl font-semibold mb-4 text-red-600">
        Confirm Image Deletion
       </h3>
       <p class="text-gray-500 mb-6">
        Are you sure you want to delete Banner Image? This action cannot be undone.
       </p>
       <div class="flex justify-end">
        <button class="bg-gray-300 text-gray-700 px-4 py-2 rounded-md mr-2" onclick="closeDeleteModal('deleteBannerModal')" type="button">
         Cancel
        </button>
        <button onclick="deleteBanner()" class="bg-red-600 text-white px-4 py-2 rounded-md"  type="submit">
         Confirm
        </button>
       </div>
      </div>
    </div> 
    <!--profile model-->
    <div class="fixed z-50 inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden" id="deleteProfileModal">
     <div class="bg-white rounded-lg shadow-md p-6 w-96">
      <h3 class="text-xl font-semibold mb-4 text-red-600">
       Confirm Image Deletion
      </h3>
      <p class="text-gray-500 mb-6">
       Are you sure you want to delete Profile Picture? This action cannot be undone.
      </p>
      <div class="flex justify-end">
       <button class="bg-gray-300 text-gray-700 px-4 py-2 rounded-md mr-2" onclick="closeDeleteModal('deleteProfileModal')" type="button">
        Cancel
       </button>
       <button class="bg-red-600 text-white px-4 py-2 rounded-md" onclick="deleteProfile()" type="submit">
        Confirm
       </button>
      </div>
     </div>
    </div>
    <!--Account delete model-->
    <div class="fixed z-50 inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden" id="deleteAccountModal">
     <div class="bg-white rounded-lg shadow-md p-6 w-96">
      <h3 class="text-xl font-semibold mb-4 text-red-600">
       Confirm Account Deletion
      </h3>
      <p class="text-gray-500 mb-6">
       Are you sure you want to delete your account? This action cannot be undone.
      </p>
      <div class="flex justify-end">
       <button class="bg-gray-300 text-gray-700 px-4 py-2 rounded-md mr-2" onclick="closeDeleteModal('deleteAccountModal')" type="button">
        Cancel
       </button>
       <form class="delete_user" method="post" action="{% url 'delete_user' %}" name="deleteUser">
        {% csrf_token %}
        <button class="bg-red-600 text-white px-4 py-2 rounded-md" type="submit">
         Confirm
        </button>
       </form>
      </div>
     </div>
    </div>
    <!--Twitter model-->
    <div class="fixed z-50 inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden" id="deleteTwitterModal">
      <div class="bg-white rounded-lg shadow-md p-6 w-96">
       <h3 class="text-xl font-semibold mb-4 text-red-600">
        Confirm Twitter Deletion
       </h3>
       <p class="text-gray-500 mb-6">
        Are you sure you want to delete this Twitter link? This action cannot be undone.
       </p>
       <div class="flex justify-end">
        <button class="bg-gray-300 text-gray-700 px-4 py-2 rounded-md mr-2" onclick="closeDeleteModal('deleteTwitterModal')" type="button">
         Cancel
        </button>
        <a href="{% url 'delete_social_link' 'twitter' %}" class="bg-red-600 text-white px-4 py-2 rounded-md" type="button">
         Confirm
        </a>
       </div>
      </div>
    </div>
    <!--Facebook model-->
    <div class="fixed z-50 inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden" id="deleteFacebookModal">
      <div class="bg-white rounded-lg shadow-md p-6 w-96">
       <h3 class="text-xl font-semibold mb-4 text-red-600">
        Confirm Facebook Deletion
       </h3>
       <p class="text-gray-500 mb-6">
        Are you sure you want to delete this Facebook link? This action cannot be undone.
       </p>
       <div class="flex justify-end">
        <button class="bg-gray-300 text-gray-700 px-4 py-2 rounded-md mr-2" onclick="closeDeleteModal('deleteFacebookModal')" type="button">
         Cancel
        </button>
        <a href="{% url 'delete_social_link' 'facebook' %}" class="bg-red-600 text-white px-4 py-2 rounded-md" type="button">
         Confirm
        </a>
       </div>
     </div>
    </div>
    <!--Instagram model-->
    <div class="fixed z-50 inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden" id="deleteInstagramModal">
      <div class="bg-white rounded-lg shadow-md p-6 w-96">
       <h3 class="text-xl font-semibold mb-4 text-red-600">
        Confirm Instagram Deletion
       </h3>
       <p class="text-gray-500 mb-6">
        Are you sure you want to delete this Instagram link? This action cannot be undone.
       </p>
       <div class="flex justify-end">
        <button class="bg-gray-300 text-gray-700 px-4 py-2 rounded-md mr-2" onclick="closeDeleteModal('deleteInstagramModal')" type="button">
         Cancel
        </button>
        <a href="{% url 'delete_social_link' 'instagram' %}" class="bg-red-600 text-white px-4 py-2 rounded-md" type="button">
         Confirm
        </a>
       </div>
     </div>
    </div>
    <!--Snapchat model-->
    <div class="fixed z-50 inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden" id="deleteSnapchatModal">
      <div class="bg-white rounded-lg shadow-md p-6 w-96">
       <h3 class="text-xl font-semibold mb-4 text-red-600">
        Confirm Snapchat Deletion
       </h3>
       <p class="text-gray-500 mb-6">
        Are you sure you want to delete this Snapchat link? This action cannot be undone.
       </p>
       <div class="flex justify-end">
        <button class="bg-gray-300 text-gray-700 px-4 py-2 rounded-md mr-2" onclick="closeDeleteModal('deleteSnapchatModal')" type="button">
         Cancel
        </button>
        <a href="{% url 'delete_social_link' 'snapchat' %}" class="bg-red-600 text-white px-4 py-2 rounded-md" type="button">
          Confirm
        </a>
       </div>
     </div>
    </div>
    <!--YouTube model-->
    <div class="fixed z-50 inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden" id="deleteYouTubeModal">
      <div class="bg-white rounded-lg shadow-md p-6 w-96">
       <h3 class="text-xl font-semibold mb-4 text-red-600">
        Confirm YouTube Deletion
       </h3>
       <p class="text-gray-500 mb-6">
        Are you sure you want to delete this YouTube link? This action cannot be undone.
       </p>
       <div class="flex justify-end">
        <button class="bg-gray-300 text-gray-700 px-4 py-2 rounded-md mr-2" onclick="closeDeleteModal('deleteYouTubeModal')" type="button">
         Cancel
        </button>
        <a href="{% url 'delete_social_link' 'youtube' %}" class="bg-red-600 text-white px-4 py-2 rounded-md" type="button">
          Confirm
        </a>
       </div>
     </div>
    </div>
    <!--Reddit model-->
    <div class="fixed z-50 inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden" id="deleteRedditModal">
      <div class="bg-white rounded-lg shadow-md p-6 w-96">
       <h3 class="text-xl font-semibold mb-4 text-red-600">
        Confirm Reddit Deletion
       </h3>
       <p class="text-gray-500 mb-6">
        Are you sure you want to delete this Reddit link? This action cannot be undone.
       </p>
       <div class="flex justify-end">
        <button class="bg-gray-300 text-gray-700 px-4 py-2 rounded-md mr-2" onclick="closeDeleteModal('deleteRedditModal')" type="button">
         Cancel
        </button>
        <a href="{% url 'delete_social_link' 'reddit' %}" class="bg-red-600 text-white px-4 py-2 rounded-md" type="button">
          Confirm
        </a>
       </div>
     </div>
    </div>
    <!--Pinterest model-->
    <div class="fixed z-50 inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden" id="deletePinterestModal">
      <div class="bg-white rounded-lg shadow-md p-6 w-96">
       <h3 class="text-xl font-semibold mb-4 text-red-600">
        Confirm Pinterest Deletion
       </h3>
       <p class="text-gray-500 mb-6">
        Are you sure you want to delete this Pinterest link? This action cannot be undone.
       </p>
       <div class="flex justify-end">
        <button class="bg-gray-300 text-gray-700 px-4 py-2 rounded-md mr-2" onclick="closeDeleteModal('deletePinterestModal')" type="button">
         Cancel
        </button>
        <a href="{% url 'delete_social_link' 'pinterest' %}" class="bg-red-600 text-white px-4 py-2 rounded-md" type="button">
          Confirm
        </a>
       </div>
     </div>
    </div>
    <!--Medium model-->
    <div class="fixed z-50 inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden" id="deleteMediumModal">
      <div class="bg-white rounded-lg shadow-md p-6 w-96">
       <h3 class="text-xl font-semibold mb-4 text-red-600">
        Confirm Medium Deletion
       </h3>
       <p class="text-gray-500 mb-6">
        Are you sure you want to delete this Medium link? This action cannot be undone.
       </p>
       <div class="flex justify-end">
        <button class="bg-gray-300 text-gray-700 px-4 py-2 rounded-md mr-2" onclick="closeDeleteModal('deleteMediumModal')" type="button">
         Cancel
        </button>
        <a href="{% url 'delete_social_link' 'medium' %}" class="bg-red-600 text-white px-4 py-2 rounded-md" type="button">
          Confirm
        </a>
       </div>
     </div>
    </div>
    <!--Github model-->
    <div class="fixed z-50 inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden" id="deleteGithubModal">
      <div class="bg-white rounded-lg shadow-md p-6 w-96">
       <h3 class="text-xl font-semibold mb-4 text-red-600">
        Confirm Github Deletion
       </h3>
       <p class="text-gray-500 mb-6">
        Are you sure you want to delete this Github link? This action cannot be undone.
       </p>
       <div class="flex justify-end">
        <button class="bg-gray-300 text-gray-700 px-4 py-2 rounded-md mr-2" onclick="closeDeleteModal('deleteGithubModal')" type="button">
         Cancel
        </button>
        <a href="{% url 'delete_social_link' 'github' %}" class="bg-red-600 text-white px-4 py-2 rounded-md" type="button">
          Confirm
        </a>
       </div>
      </div>
    </div>
    <!--Linkedin model-->
    <div class="fixed z-50 inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden" id="deleteLinkedInModal">
      <div class="bg-white rounded-lg shadow-md p-6 w-96">
       <h3 class="text-xl font-semibold mb-4 text-red-600">
        Confirm Linkedin Deletion
       </h3>
       <p class="text-gray-500 mb-6">
        Are you sure you want to delete this LinkedIn link? This action cannot be undone.
       </p>
       <div class="flex justify-end">
        <button class="bg-gray-300 text-gray-700 px-4 py-2 rounded-md mr-2" onclick="closeDeleteModal('deleteLinkedInModal')" type="button">
         Cancel
        </button>
        <a href="{% url 'delete_social_link' 'linkedin' %}" class="bg-red-600 text-white px-4 py-2 rounded-md" type="button">
          Confirm
        </a>
       </div>
      </div>
    </div>
    <!--Category model-->
    <div id="category-modal" class="fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center hidden">
      <div class="bg-white p-6 rounded-lg shadow-lg w-96">
          <h2 class="text-xl font-bold text-blue-900 mb-4">Add New Category</h2>
          <form method="post" action="{% url 'add_category' %}">
            {% csrf_token %}
            <input required type="text" id="new-category" placeholder="Category name" name="category_name" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-600 mb-4">
            <div class="flex justify-end">
                <button type="button" id="cancel-category-button" class="bg-gray-500 text-white px-4 py-2 rounded-lg shadow-lg hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 mr-2">Cancel</button>
                <button type="submit" id="save-category-button" class="bg-purple-600 text-white px-4 py-2 rounded-lg shadow-lg hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500">Save</button>
            </div>
          </form>
      </div>
    </div>
    <script>
      tinymce.init({
        selector: '#bio',
        height: 600,
        menubar: true,
        plugins: [
          'advlist','anchor', 'image media link code', 'autolink', 'charmap', 'codesample', 'emoticons', 'image', 'link', 'lists', 'media', 'table', 'visualblocks', 'wordcount',
          'fullscreen', 'print', 'preview', 'insertdatetime', 'media', 'linkchecker',
        ],
        toolbar: 'undo redo | blocks fontfamily fontsize | styleselect | bold italic underline backcolor strikethrough | link image media table mergetags | align lineheight | numlist bullist indent outdent | emoticons charmap  | code | removeformat', 
        //content_css: 'writer'
        //statusbar: false
        content_style: 'div :focus { margin: 10px; padding: 3px; }'
      });
    </script> 
    <script>
      tinymce.init({
        selector: '#content',
        height: 600,
        menubar: true,
        plugins: [
          'advlist','anchor', 'image media link code', 'autolink', 'charmap', 'codesample', 'emoticons', 'image', 'link', 'lists', 'media', 'table', 'visualblocks', 'wordcount',
          'fullscreen', 'print', 'preview', 'insertdatetime', 'media', 'linkchecker',
        ],
        toolbar: 'undo redo | blocks fontfamily fontsize | styleselect | bold italic underline backcolor strikethrough | link image media table mergetags | align lineheight | numlist bullist indent outdent | emoticons charmap  | code | removeformat', 
        //content_css: 'writer'
        //statusbar: false
        content_style: 'div :focus { margin: 10px; padding: 3px; }'
      });
    </script>
    <script>
      function RedirectToDashboard() {
        window.location.href = "{% url 'dashboard' %}"
      }
      function create_post_URL() {
        window.location.href = "{% url 'create_post' %}";
      }
      function goBack() {
        window.history.go(-1);
      }
      function notificationRedirect(){
        window.location.href = "{% url 'mark_read' %}";
      }
      function deleteBanner(){
        window.location.href = "{% url 'delete_banner_image' %}"
      }
      function deleteProfile(){
        window.location.href = "{% url 'delete_profile_image' %}"
      }
      function refreshUsers(){
        window.location.reload();
      }
      function settingsUrl(){
        window.location.href = "{% url 'settings' %}"
      }
      function toggleSearch() {
        const searchIcon = document.getElementById("search-icon");
        const closeIcon = document.getElementById("close-icon");
        const logo = document.getElementById("logo");
        const searchDiv = document.getElementById("search-div")
        const searchInput = document.getElementById("mobile-search-input");
        const searchResults = document.getElementById("mobile-search-results")
      
        if (searchIcon.classList.contains("hidden")) {
          searchIcon.classList.remove("hidden");
          closeIcon.classList.add("hidden");
          logo.classList.remove("hidden");
          searchDiv.classList.add("hidden");
        } else {
          searchIcon.classList.add("hidden");
          closeIcon.classList.remove("hidden");
          logo.classList.add("hidden");
          searchDiv.classList.remove("hidden");
          searchInput.focus();
        }
      }
      function homeRedirect(){
        window.location.href = "{% url 'home' %}";
      }
      function RedirectToUrl(pageUrl){
        window.location.href = pageUrl;
      }
      function showLogoutModal() {
        document.getElementById("logoutModal").style.display = "block"
      }
      function hideLogoutModal() {
        document.getElementById("logoutModal").style.display = "none"
      }
      function showSidebarModel(){
        const SidebarModal = document.getElementById("sidebarModal")
        const sidebar = document.getElementById("sidebar")
        sidebarModal.style.display = "block";
        document.body.classList.add('overflow-hidden');
        setTimeout(function(){
          sidebar.classList.add('show')
          sidebar.classList.remove('hide')
        }, 200);
      }
      function hideSidebarModel(){
        const SidebarModal = document.getElementById("sidebarModal")
        const sidebar = document.getElementById("sidebar")
        sidebar.classList.add('hide')
        sidebar.classList.remove('show')
        setTimeout(function(){
          sidebarModal.style.display = "none";
          document.body.classList.remove('overflow-hidden');
        }, 200);
      }
        
      function toggleDropdown() {
        const dropdown = document.getElementById('accountDropdown');
        const accountDiv = document.getElementById('accountDiv');
        const arrow = document.getElementById('accountArrow');
        //dropdown.classList.toggle('hidden');
        if (dropdown.classList.contains('expanded')) {
          dropdown.style.maxHeight = '0';
          dropdown.classList.remove('expanded');
        }
        else {
          dropdown.style.maxHeight = `${dropdown.scrollHeight}px`;
          dropdown.classList.add('expanded');
        }
        accountDiv.classList.toggle('border-b');
        accountDiv.classList.toggle('border-blue-900');
        arrow.classList.toggle('fa-chevron-down');
        arrow.classList.toggle('fa-chevron-up');
      }
      function toggleDropdownMenu() {
        const dropdown = document.getElementById('accountDropdownMenu');
        const accountDiv = document.getElementById('accountDivMenu');
        const arrow = document.getElementById('accountArrowMenu');
        //dropdown.classList.toggle('hidden');
        if (dropdown.classList.contains('expanded')) {
          dropdown.style.maxHeight = '0';
          dropdown.classList.remove('expanded');
        }
        else {
          dropdown.style.maxHeight = `${dropdown.scrollHeight}px`;
          dropdown.classList.add('expanded');
        }
        accountDiv.classList.toggle('border-b');
        accountDiv.classList.toggle('border-blue-900');
        arrow.classList.toggle('fa-chevron-down');
        arrow.classList.toggle('fa-chevron-up');
      }
      function toggleDropdownSidebar() {
        const dropdown = document.getElementById('accountDropdownSidebar');
        const accountDiv = document.getElementById('accountDivSidebar');
        const arrow = document.getElementById('accountArrowSidebar');
        //dropdown.classList.toggle('hidden');
        if (dropdown.classList.contains('expanded')) {
          dropdown.style.maxHeight = '0';
          dropdown.classList.remove('expanded');
        }
        else {
          dropdown.style.maxHeight = `${dropdown.scrollHeight}px`;
          dropdown.classList.add('expanded');
        }
        accountDiv.classList.toggle('border-b');
        accountDiv.classList.toggle('border-blue-900');
        arrow.classList.toggle('fa-chevron-down');
        arrow.classList.toggle('fa-chevron-up');
      }

      function togglePasswordVisibility(inputId, iconId) {
        const passwordInput = document.getElementById(inputId);
        const toggleIcon = document.getElementById(iconId);

        if (passwordInput.type === "password") {
          passwordInput.type = "text";
          toggleIcon.src =
            "https://cdn-icons-png.flaticon.com/512/6704/6704951.png"; // Change to 'hide' icon
        } else {
          passwordInput.type = "password";
          toggleIcon.src =
            "https://cdn-icons-png.flaticon.com/512/8860/8860683.png"; // Change to 'show' icon
        }
      }
      setTimeout(function () {
        const alert = document.querySelector(".alert");
        if (alert) {
          alert.style.display = "none";
        }
      }, 2000);

      function showLoginMessage() {
        document.getElementById("loginModal").style.display = "block";
      }

      function closeModal() {
        document.getElementById("loginModal").style.display = "none";
      }

      // Get the button
      const scrollToTopBtn = document.getElementById("scrollToTopBtn");

      // Show the button when the user scrolls down 500px
      window.onscroll = function () {
        // scroll to top logic
        if (
          document.body.scrollTop > 500 ||
          document.documentElement.scrollTop > 500
        ) {
          scrollToTopBtn.classList.remove("hidden");
        } else {
          scrollToTopBtn.classList.add("hidden");
        }

        //fixed header logic
        const head = document.querySelector(".head");
        if (
          document.body.scrollTop > 50 ||
          document.documentElement.scrollTop > 50
        ) {
          head.classList.add("fixed-header");
        } else {
          head.classList.remove("fixed-header");
        }
      };

      // Scroll to the top when the button is clicked
      scrollToTopBtn.onclick = function () {
        window.scrollTo({
          top: 0,
          behavior: "smooth", // Smooth scroll effect
        });
      };
      // take loading container class
      const loadingContainer = document.getElementById("loadingFrame");
      const loadedContainer = document.getElementById("loadedFrame");
      function showLoading() {
        loadingContainer.classList.add("flex"); // Show loading frame
      }

      function hideLoading() {
        loadingContainer.classList.add("hidden"); // Hide loading frame
        loadedContainer.classList.remove("hidden");
        loadedContainer.classList.add("flex")
      }
      window.addEventListener("beforeunload", function () {
        showLoading(); // Show loading screen when navigating away
      });
      // Example usage
      window.onload = function () {
        hideLoading(); // Hide loading frame when the page is fully loaded
      };
      // Function to toggle comment menu
      function toggleMenu(menuId) {
        const menu = document.getElementById(menuId);
        if (menu.classList.contains('hidden')) {
          document.querySelectorAll('.menu').forEach(m => {
            if (m.id !== menuId) {
              m.classList.add('hidden');
            }
          });
          menu.classList.remove('hidden');
        }
        else {
          menu.classList.add('hidden');
        }
      }
      document.addEventListener('click', function(event) {
        if (!event.target.closest('.three-dots-btn') && !event.target.closest('.menu')) {
          document.querySelectorAll('.menu').forEach(menu => {
            menu.classList.add('hidden');
          });
        }
      });
      // Function to share a post
      function sharePost(title, url) {
        if (navigator.share) {
          // Use the Web Share API
          navigator
            .share({
              title: title,
              url: url,
            })
            .then(() => console.log("Post shared successfully!"))
            .catch((error) => console.error("Error sharing:", error));
        } else {
          // Fallback for browsers that do not support the Web Share API
          const shareText = `Check out this post: ${title} - ${url}`;
          navigator.clipboard
            .writeText(shareText)
            .then(() => alert("Post link copied to clipboard!"))
            .catch((error) => console.error("Error copying text:", error));
        }
      }

      // Function to share a user profile
      function shareUser (username, profileUrl) {
        if (navigator.share) {
            // Use the Web Share API
            navigator.share({
                title: `${username}'s Profile`,
                url: profileUrl
            }).then(() => {
                console.log('Profile shared successfully!');
            }).catch((error) => {
                console.error('Error sharing profile:', error);
            });
        } else {
            // Fallback for browsers that do not support the Web Share API
            navigator.clipboard.writeText(profileUrl).then(() => {
                alert('Profile URL copied to clipboard!');
            }).catch((error) => {
                console.error('Error copying to clipboard:', error);
            });
        }
      }

      // Function to open the image modal
      function openImageModal(imageUrl) {
        const modal = document.getElementById("imageModal");
        const fullImage = document.getElementById("fullImage");
        fullImage.src = imageUrl; // Set the source of the full image
        modal.style.display = "flex"; // Show the modal
      }

      // Function to close the image modal
      function closeImageModal() {
        const modal = document.getElementById("imageModal");
        modal.style.display = "none"; // Hide the modal
      }

      // Close the modal when clicking outside of the image
      window.onclick = function (event) {
        const modal = document.getElementById("imageModal");
        if (event.target == modal) {
          closeImageModal();
        }
      };

      // Function to toggle the comment section
      function toggleCommentSection() {
       const commentsSection = document.getElementById("commentsSection");
       const commentPart = document.getElementById('comment-section');
       const likePart= document.getElementById('like-section');
       const commentTab = document.getElementById('comment-tab');
       const likeTab = document.getElementById('like-tab');
        if (
          commentsSection.style.height === "0px" ||
          commentsSection.style.height === ""
        ) {
          commentsSection.style.height = commentsSection.scrollHeight + "px";
          commentPart.classList.remove('hidden');
          likePart.classList.add('hidden');
          commentTab.classList.add('border-2', 'border-blue-500', 'rounded-full', 'bg-blue-500', 'text-white');
          likeTab.classList.remove('border-2', 'border-red-600', 'rounded-full', 'bg-red-600', 'text-white');
        } else {
          commentsSection.style.height = "0px";
        }
      }

      // function for like of the post
      function toggleLike(postId) {
        fetch(`/toggle_like/${postId}/`, {
            method: 'POST',
            headers: {
                'X-CSRFToken': '{{ csrf_token }}',  // Include CSRF token for security
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({})
        })
        .then(response => response.json())
        .then(data => {
            const likeIcon = document.getElementById('likeIcon');
            const likeCount = document.getElementById('likeCount');
            const likePart = document.getElementById('like-part');
            const NoLike = document.getElementById('NoLike');
            console.log(data)
            // Update the like icon and count
            if (data.liked) {
                likeIcon.classList.remove('far');  // Remove empty heart
                likeIcon.classList.add('fas');     // Add filled heart
                NoLike.classList.add('hidden');
                NoLike.classList.remove('flex');
                likeCount.textContent = data.total_likes;  
            } else {
                likeIcon.classList.remove('fas');  // Remove filled heart
                likeIcon.classList.add('far');     // Add empty heart
                if (data.total_likes >= 1){
                  NoLike.classList.add('hidden');
                  NoLike.classList.remove('flex');
                  likeCount.textContent = data.total_likes;
                } else {
                  NoLike.classList.remove('hidden');
                  NoLike.classList.add('flex');
                  likeCount.textContent = '';
                }
            }
    
            // Append user information to the like section
            if (data.liked) {
              const userHtml = `
                  <div class="flex items-center justify-between hover:bg-gray-300 p-2 rounded-md">
                      {% if request.user.is_authenticated %}
                      <div onclick="RedirectToUrl('{% url 'user_profile' request.user.username %}')" class="like-user flex items-center space-x-4 cursor-pointer">
                          <img
                              alt="${data.user.username}'s profile picture"
                              class="rounded-full h-10 user-image"
                              height="40"
                              width="40"
                              src="${data.user.profile_picture_url || '{% static '/no-profile-pic.png' %}'}"
                          />
                          <div class="flex flex-col">
                            <div class="text-red-700 font-semibold">
                              <span class="text-red-700 font-semibold">${data.user.first_name} ${data.user.last_name} (you)</span>
                              {% if request.user == post.author %}
                              <span class="border-2 bg-blue-100 p-1 text-sm rounded-lg"
                                ><strong>Author</strong></span>
                              {% endif %}
                            </div>
                            <span class="username text-gray-500 text-sm mt-[-5px]">@${data.user.username}</span>
                          </div>
                      </div>
                      <button onclick="RedirectToUrl('{% url 'user_profile' request.user.username %}')" class="bg-red-500 text-white px-4 py-1 rounded-md hover:bg-red-700">
                       <i class="fas fa-cog"></i>
                       <span>Settings</span>
                      </button>
                      {% endif %}
                  </div>
                `;
              likePart.innerHTML += userHtml;
            } else {
                // Remove the user information from the like section
                const userElement = likePart.querySelector(`.like-user img[src="${data.user.profile_picture_url || '{% static '/no-profile-pic.png' %}'}"]`);
                if (userElement) {
                    userElement.parentNode.parentNode.remove();
                }
            }
        })
        .catch(error => console.error('Error:', error));
      }

      // function to delayed form submit
      function delayedSubmit(form) {
        clearTimeout(window.delayedSubmitTimeout);
        window.delayedSubmitTimeout = setTimeout(function() {
          form.submit();
        }, 500); // adjust the delay time as needed
      }

      function aboutBlurText() {
        let text = document.getElementById('read-more');
        let fullText = document.getElementById('full-text');
        let shortText = document.getElementById('short-text');
        let aboutMe = document.getElementById('about-me');
        if (fullText.classList.contains('hidden')) {
          fullText.classList.remove('hidden');
          shortText.classList.add('hidden');
          aboutMe.classList.remove('blurred');
          text.textContent = 'Read Less';
        } else {
          fullText.classList.add('hidden');
          shortText.classList.remove('hidden');
          aboutMe.classList.add('blurred');
          text.textContent = 'Read More';
        }
      }

      function toggleView(view) {
        const postContainer = document.getElementById('post-container');
        const buttons = document.querySelectorAll('.toggle-view button');
        buttons.forEach(button => button.classList.remove('active'));
        if (view === 'tile') {
            postContainer.classList.remove('list-view');
            postContainer.classList.add('grid', 'grid-cols-1', 'md:grid-cols-2', 'lg:grid-cols-3', 'gap-6');
            buttons[0].classList.add('active');
        } else {
            postContainer.classList.remove('grid', 'grid-cols-1', 'md:grid-cols-2', 'lg:grid-cols-3', 'gap-6');
            postContainer.classList.add('list-view');
            buttons[1].classList.add('active');
        }
      }
      function toggleView1(view) {
        const postContainer = document.getElementById('post-container1');
        const buttons = document.querySelectorAll('.toggle-view1 button');
        buttons.forEach(button => button.classList.remove('active'));
        if (view === 'tile') {
            postContainer.classList.remove('list-view');
            postContainer.classList.add('grid', 'grid-cols-1', 'md:grid-cols-2', 'lg:grid-cols-3', 'gap-6');
            buttons[0].classList.add('active');
        } else {
            postContainer.classList.remove('grid', 'grid-cols-1', 'md:grid-cols-2', 'lg:grid-cols-3', 'gap-6');
            postContainer.classList.add('list-view');
            buttons[1].classList.add('active');
        }
      }
      function toggleView2(view) {
        const postContainer = document.getElementById('post-container2');
        const buttons = document.querySelectorAll('.toggle-view2 button');
        buttons.forEach(button => button.classList.remove('active'));
        if (view === 'tile') {
            postContainer.classList.remove('list-view');
            postContainer.classList.add('grid', 'grid-cols-1', 'md:grid-cols-2', 'lg:grid-cols-3', 'gap-6');
            buttons[0].classList.add('active');
        } else {
            postContainer.classList.remove('grid', 'grid-cols-1', 'md:grid-cols-2', 'lg:grid-cols-3', 'gap-6');
            postContainer.classList.add('list-view');
            buttons[1].classList.add('active');
        }
      } 

      function showSection(section, element) {
         const sections = ['posts', 'followers', 'following'];
         sections.forEach(sec => {
             document.getElementById(sec).classList.add('hidden');
         });
         document.getElementById(section).classList.remove('hidden');
 
         const tabs = document.querySelectorAll('.tabs a');
         tabs.forEach(tab => tab.classList.remove('active'));
         element.classList.add('active');
      }

      function followUnfollow(button, username) {
        const followButton = document.querySelectorAll(`.follow-button-${username}`);
        //const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
      
        fetch(`/follow_unfollow/${username}/`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': '{{ csrf_token }}',  // Include CSRF token for security
          },
          body: JSON.stringify({ username: username })
        })
        .then(response => response.json())
        .then(data => {
          console.log(data)
          if (data.success) {
            if (data.following) {
              followButton.forEach(button => {
                button.innerHTML = '<i class="fas fa-user-check"></i> <span>Following</span>';
              });
            } else {
              followButton.forEach(button => {
                button.innerHTML = '<i class="fas fa-user-plus"></i> <span>Follow</span>';
              });
            }
          } else {
            console.error('Error following or unfollowing user:', data.error);
          }
        })
        .catch(error => {
          console.error('Error following or unfollowing user:', error);
        });
      }

      function toggle_following() {
        const recentButton = document.getElementById('recent_following_button')
        const oldestButton = document.getElementById('oldest_following_button')
        const recentFollowings = document.getElementById('recent_followings')
        const oldestFollowings = document.getElementById('oldest_followings')

        if (oldestFollowings.classList.contains('hidden')){
          recentFollowings.classList.add('hidden')
          oldestFollowings.classList.remove('hidden')
          recentButton.classList.remove('bg-blue-500', 'hover:bg-blue-600', 'focus:ring-blue-300')
          recentButton.classList.add('bg-gray-500', 'hover:bg-gray-600', 'focus:ring-gray-300')
          oldestButton.classList.add('bg-blue-500', 'hover:bg-blue-600', 'focus:ring-blue-300')
          oldestButton.classList.remove('bg-gray-500', 'hover:bg-gray-600', 'focus:ring-gray-300')
        } else {
          recentFollowings.classList.remove('hidden')
          oldestFollowings.classList.add('hidden')
          recentButton.classList.add('bg-blue-500', 'hover:bg-blue-600', 'focus:ring-blue-300')
          recentButton.classList.remove('bg-gray-500', 'hover:bg-gray-600', 'focus:ring-blue-300')
          oldestButton.classList.remove('bg-blue-500', 'hover:bg-blue-600', 'focus:ring-blue-300')
          oldestButton.classList.add('bg-gray-500', 'hover:bg-gray-600', 'focus:ring-gray-300')
        }
      }
      function toggle_follower() {
        const recentButton = document.getElementById('recent_follower_button')
        const oldestButton = document.getElementById('oldest_follower_button')
        const recentFollowers = document.getElementById('recent_followers')
        const oldestFollowers = document.getElementById('oldest_followers')

        if (oldestFollowers.classList.contains('hidden')){
          recentFollowers.classList.add('hidden')
          oldestFollowers.classList.remove('hidden')
          recentButton.classList.remove('bg-blue-500', 'hover:bg-blue-600', 'focus:ring-blue-300')
          recentButton.classList.add('bg-gray-500', 'hover:bg-gray-600', 'focus:ring-gray-300')
          oldestButton.classList.add('bg-blue-500', 'hover:bg-blue-600', 'focus:ring-blue-300')
          oldestButton.classList.remove('bg-gray-500', 'hover:bg-gray-600', 'focus:ring-gray-300')
        } else {
          recentFollowers.classList.remove('hidden')
          oldestFollowers.classList.add('hidden')
          recentButton.classList.add('bg-blue-500', 'hover:bg-blue-600', 'focus:ring-blue-300')
          recentButton.classList.remove('bg-gray-500', 'hover:bg-gray-600', 'focus:ring-blue-300')
          oldestButton.classList.remove('bg-blue-500', 'hover:bg-blue-600', 'focus:ring-blue-300')
          oldestButton.classList.add('bg-gray-500', 'hover:bg-gray-600', 'focus:ring-gray-300')
        }
      }
      function toggle_post() {
        const recentButton = document.getElementById('recent_post_button')
        const oldestButton = document.getElementById('oldest_post_button')
        const recentPosts = document.getElementById('recent_posts')
        const oldestPosts = document.getElementById('oldest_posts')

        if (oldestPosts.classList.contains('hidden')){
          recentPosts.classList.add('hidden')
          oldestPosts.classList.remove('hidden')
          recentButton.classList.remove('bg-blue-500', 'hover:bg-blue-600', 'focus:ring-blue-300')
          recentButton.classList.add('bg-gray-500', 'hover:bg-gray-600', 'focus:ring-gray-300')
          oldestButton.classList.add('bg-blue-500', 'hover:bg-blue-600', 'focus:ring-blue-300')
          oldestButton.classList.remove('bg-gray-500', 'hover:bg-gray-600', 'focus:ring-gray-300')
        } else {
          recentPosts.classList.remove('hidden')
          oldestPosts.classList.add('hidden')
          recentButton.classList.add('bg-blue-500', 'hover:bg-blue-600', 'focus:ring-blue-300')
          recentButton.classList.remove('bg-gray-500', 'hover:bg-gray-600', 'focus:ring-blue-300')
          oldestButton.classList.remove('bg-blue-500', 'hover:bg-blue-600', 'focus:ring-blue-300')
          oldestButton.classList.add('bg-gray-500', 'hover:bg-gray-600', 'focus:ring-gray-300')
        }
      }

      function toggleEdit() {
        const inputs = document.querySelectorAll('.account-info input:not([type="email"], [name="csrfmiddlewaretoken"]), .account-info textarea');
        const nonText = document.getElementById('non-text');
        const bio = document.querySelector('.tox')
        const saveButton = document.getElementById('saveButton');
        inputs.forEach(input => {
          input.disabled = !input.disabled;
        });
       nonText.classList.toggle('hidden')
        if (saveButton.classList.contains('bg-gray-500')){
          saveButton.classList.remove('bg-gray-500', 'hover:bg-gray-400');
          saveButton.classList.add('bg-purple-600', 'hover:bg-purple-500');
          bio.style.display = ''
        } else {
          saveButton.classList.remove('bg-purple-600', 'hover:bg-purple-500');
          saveButton.classList.add('bg-gray-500', 'hover:bg-gray-400');
          bio.style.display = 'none'
        }
        saveButton.disabled = !saveButton.disabled;
      }

      function toggleSocialEdit(inputId, saveButtonId) {
        const input = document.getElementById(inputId);
        const saveButton = document.getElementById(saveButtonId);
        input.disabled = !input.disabled;
        checkSocialInputs();
      }
   
      function checkSocialInputs() {
        const socialInputs = document.querySelectorAll('.social-input');
        const socialSaveButton = document.getElementById('socialSaveButton');
        let anyEnabled = false;
        socialInputs.forEach(input => {
          if (!input.disabled) {
            anyEnabled = true;
          }
        });
        socialSaveButton.disabled = !anyEnabled;
        if (!socialSaveButton.disabled){
          socialSaveButton.classList.remove('bg-gray-500', 'hover:bg-gray-400');
          socialSaveButton.classList.add('bg-purple-600', 'hover:bg-purple-500');
        } else {
          socialSaveButton.classList.remove('bg-purple-600', 'hover:bg-purple-500');
          socialSaveButton.classList.add('bg-gray-500', 'hover:bg-gray-400');
        }
        //socialSaveButton.disabled = !anyEnabled;
      }
   
      function openDeleteModal(modalId) {
        document.getElementById(modalId).classList.remove('hidden');
      }
   
      function closeDeleteModal(modalId) {
        document.getElementById(modalId).classList.add('hidden');
      }

      function checkInputFields() {
        let profileInput = document.getElementById('profile-input');
        let bannerInput = document.getElementById('banner-input');
        let saveButton = document.getElementById('imageSaveButton');
      
        if (profileInput.files.length > 0 || bannerInput.files.length > 0) {
          saveButton.disabled = false;
          saveButton.classList.remove('bg-gray-500', 'hover:bg-gray-400');
          saveButton.classList.add('bg-purple-600', 'hover:bg-purple-500');
        } else {
          saveButton.disabled = true;
          saveButton.classList.remove('bg-purple-600', 'hover:bg-purple-500');
          saveButton.classList.add('bg-gray-500', 'hover:bg-gray-400');
        }
      }

      function previewBannerImage() {
        let bannerImage = document.getElementById('banner-image');
        let bannerInput = document.getElementById('banner-input');
        let file = bannerInput.files[0];
        let reader = new FileReader();
        reader.onload = function(event) {
            bannerImage.src = event.target.result;
        };
        reader.readAsDataURL(file);
      }
      
      function previewProfileImage() {
        let profileImage = document.getElementById('profile-image');
        let profileInput = document.getElementById('profile-input');
        let file = profileInput.files[0];
        let reader = new FileReader();
        reader.onload = function(event) {
            profileImage.src = event.target.result;
        };
        reader.readAsDataURL(file);
      } 

      function openTab(evt, tabName) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
          tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
          tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(tabName).style.display = "block";
        //evt.currentTarget.className += " active";
        var tabButton = document.querySelector(`button[onclick="openTab(event, '${tabName}')"]`);
        tabButton.className += " active";

        // Update the URL with the current tab
        var url = new URL(window.location.href);
        url.searchParams.set('tab', tabName);
        window.history.pushState({}, '', url.href);
      }

      // Get the current tab from the query parameter
      const urlParams = new URLSearchParams(window.location.search);
      const currentTab = urlParams.get('tab');
      // Open the correct tab on page load
      document.addEventListener('DOMContentLoaded', function() {
        if (currentTab) {
          openTab(event, currentTab);
        } else {
          // If no tab is specified, open the first tab
          //openTab(event, 'GeneralSettings');
          document.getElementById("defaultOpen").click();
        }
      });

      {% comment %} document.addEventListener("DOMContentLoaded", function() {
        document.getElementById("defaultOpen").click();
      }); {% endcomment %}

      // Get the search input fields
      const desktopSearchInput = document.getElementById('search-input');
      const mobileSearchInput = document.getElementById('mobile-search-input');
      
      // Get the search results container
      const searchResultsContainer = document.getElementById('search-results');
      const searchResultsContainerM = document.getElementById('mobile-search-results');
      
      // Function to show search results
      function showSearchResults() {
        searchResultsContainer.classList.remove('hidden');
        searchResultsContainerM.classList.remove('hidden');
      }
      // Function to hiqde search results
      {% comment %} function hideSearchResults() {
        setTimeout(() => {
            searchResultsContainer.classList.add('hidden');
            searchResultsContainerM.classList.add('hidden');
        }, 500); // delay hiding by 200ms
      } {% endcomment %}
      
      // Function to fetch search results
      function fetchSearchResults(query) {
        // Make an AJAX request to fetch search results
        fetch('/search/', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': '{{ csrf_token }}',
          },
          body: JSON.stringify({ query: query }),
        })
        .then(response => response.json())
        .then(data => {
          console.log('Search results:', data);
          // Update the search results container
          searchResultsContainer.innerHTML = '';
          searchResultsContainerM.innerHTML = '';
          if (data.results.length > 0) {
            data.results.forEach(result => {
              if (result.type === 'post') {
                  const postHTML = `
                      {% if request.user.is_authenticated %}
                      <a href="${result.data.url}" class="search-result flex items-start space-x-4 p-3 border-b border-gray-200 hover:bg-gray-200">
                          <img class="rounded-lg" width="70" height="70" src="${result.data.thumbnail}" alt="Post thumbnail">
                          <div class="flex-1">
                            <h4>${result.data.title}</h4>
                            <p>${result.data.content}</p>
                          </div>
                      </a>
                      {% endif %}
                  `;
                  searchResultsContainer.innerHTML += postHTML;
                  searchResultsContainerM.innerHTML += postHTML;
              } else if (result.type === 'user') {
                  const userHTML = `
                      {% if request.user.is_authenticated %}
                      <a href="${result.data.url}" class="search-result flex items-start space-x-4 p-3 border-b border-gray-200 hover:bg-gray-200">
                          <img class="rounded-lg" width="40" height="40" src="${result.data.profile_picture || '{% static '/no-profile-pic.png' %}'}" alt="User profile picture">
                          <div class="flex-1">
                            <h4>${result.data.first_name} ${result.data.last_name}</h4>
                            <p>@${result.data.username}</p>
                          </div>
                      </a>
                      {% endif %}
                  `;
                  searchResultsContainer.innerHTML += userHTML;
                  searchResultsContainerM.innerHTML += userHTML;
              }
            });
          } else {
            const noResultsHTML = `
              <div class="underline search-result text-2xl my-[50%] text-center">
                <p>No results found.</p>
              </div>
            `;
            searchResultsContainer.innerHTML = noResultsHTML;
            searchResultsContainerM.innerHTML = noResultsHTML;
          }
        })
        .catch(error => console.error('Error fetching search results:', error));
      }

      let timeoutId = null
      let previousLength = 0;
      function saveSearch() {
       const desktopSearchInput = document.getElementById('search-input');
       const mobileSearchInput = document.getElementById('mobile-search-input');
       const query = desktopSearchInput.value.trim() || mobileSearchInput.value.trim();
       const currentLength = query.length;
       if (currentLength > previousLength) {
          if (timeoutId) {
            clearTimeout(timeoutId);
          }
  
          timeoutId = setTimeout(() => {
            const currentQuery = desktopSearchInput.value.trim() ||  mobileSearchInput.value.trim();
            if (currentQuery !== '') {
              fetch('/save-search-query/', {
               method: 'POST',
               headers: {
                 'Content-Type': 'application/json',
                 'X-CSRFToken': '{{ csrf_token }}',
               },
               body: JSON.stringify({ query: query }),
             })
             .then(response => response.json())
             .then(data => {
               if (data.error) {
                 console.error(data.error);
               } else if (data.message === 'previous Search query delete and new created') {
                   console.log('previous Search query delete and new created');
               } else {
                   console.log('Search query saved successfully');
               }
             })
             .catch(error => console.error('Error saving search query:', error));
           }  
          }, 2000);
        }
        previousLength = currentLength;
      }

      function deleteSearchQuery(query) {
        fetch(`/delete-search-query/${query}/`, {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': '{{ csrf_token }}',
            },
            credentials: 'same-origin',
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
              // Add dynamic effect here
              const queryElement = document.querySelectorAll(`.search-query[data-query="${query}"]`);
              if (queryElement) {
                queryElement.forEach((element) => {
                  element.parentNode.classList.add('deleted');
                  setTimeout(() => {
                    element.parentNode.remove();
                  }, 500); // wait for 500ms before removing the element
                });
                //queryElement.parentNode.classList.add('deleted');
                //setTimeout(() => {
                //  queryElement.parentNode.remove();
                //}, 500); // wait for 500ms before removing the element
              }
              console.log(data.message);
            } else {
                console.error(data.error);
            }
        })
        .catch(error => console.error('Error deleting search query:', error));
      }

      function fetchRecentSearch() {
        fetch('/recent-searches/', {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': '{{ csrf_token }}',
          },
        })
        .then(response => response.json())
        .then(data => {
          if (data.length === 0) {
            // Display a message if there are no recent searches
            searchResultsContainer.innerHTML = `<div class="underline flex justify-center items-center gap-1 search-result text-2xl my-[50%] text-center">
              <p>No Search History</p>
              <i class="fa-solid fa-magnifying-glass"></i>
              </div>`;
            searchResultsContainerM.innerHTML = `<div class="underline flex justify-center items-center gap-1 search-result text-2xl my-[50%] text-center">
              <p>No Search History</p>
              <i class="fa-solid fa-magnifying-glass"></i>
              </div>`;
          } else {
            searchResultsContainer.innerHTML = '';
            searchResultsContainerM.innerHTML = '';
            data.forEach(query => {
              const queryHTML = `
                {% if request.user.is_authenticated %}
                <div class="search-result flex justify-between p-3 px-4 border-b border-gray-200 hover:bg-gray-200">
                  <div class="flex space-x-2 items-center justify-center px-2 cursor-pointer search-query" data-query="${query.query}">
                    <i class="fa-solid fa-arrow-rotate-left"></i>
                    <p>${query.query}</p>
                  </div>
                  <i class="fa-solid fa-trash-can p-2 cursor-pointer delete-icon" data-query="${query.query}"></i>
                </div>
                {% endif %}
              `;
              searchResultsContainer.innerHTML += queryHTML;
              searchResultsContainerM.innerHTML += queryHTML;
            });
            const searchQuary = document.querySelectorAll('.search-query');
            searchQuary.forEach(result =>{
              result.addEventListener('click', ()=>{
                const query = result.getAttribute('data-query')
                const searchInput = desktopSearchInput;
                const searchInputM = mobileSearchInput;
                searchInput.value = query;
                searchInputM.value = query;
                //showSearchResults()
                fetchSearchResults(query);
              });
            });
            const deleteIcons = document.querySelectorAll('.delete-icon');
            deleteIcons.forEach(icon => {
                icon.addEventListener('click', () => {
                    const queryQuery = icon.getAttribute('data-query');
                    deleteSearchQuery(queryQuery);
                });
            });
          }  
        })
        .catch(error => console.error('Error fetching recent search queries:', error));
      }


      document.addEventListener('click', function(event) {
        if (!event.target.closest('#search-input') &&
            !event.target.closest('#search-results')) {
            searchResultsContainer.classList.add('hidden');
        }
      });
      document.addEventListener('click', function(event) {
        if (!event.target.closest('#mobile-search-input') &&
            !event.target.closest('#mobile-search-results')) {
            searchResultsContainerM.classList.add('hidden');
        }
      });
      // Save search query
      // Add event listeners to search input fields
      desktopSearchInput.addEventListener('focus', showSearchResults);
      desktopSearchInput.addEventListener('focus', ()=>{
        const query = desktopSearchInput.value.trim();
        if (query !== '') {
          fetchSearchResults(query);
          //saveSearch();
        } else {
          fetchRecentSearch();
        }  
      })
      {% comment %} desktopSearchInput.addEventListener('blur', hideSearchResults); {% endcomment %}

      mobileSearchInput.addEventListener('focus', showSearchResults);
      mobileSearchInput.addEventListener('focus', ()=>{
        const query = mobileSearchInput.value.trim();
        if (query !== '') {
          fetchSearchResults(query);
          //saveSearch();
        } else {
          fetchRecentSearch();
        }  
      })
      {% comment %} mobileSearchInput.addEventListener('blur', hideSearchResults); {% endcomment %}
      
      desktopSearchInput.addEventListener('input', () => {
        const query = desktopSearchInput.value.trim();
        if (query !== '') {
          fetchSearchResults(query)
          saveSearch();
        } else {
          // Show recent search results when input is empty
          fetchRecentSearch();
          console.log("type some")
        }
      });
      
      mobileSearchInput.addEventListener('input', () => {
        showSearchResults()
        const query = mobileSearchInput.value.trim();
        if (query !== '') {
          fetchSearchResults(query);
          saveSearch();
        } else {
          // Show recent search results when input is empty
          //fetchRecentSearchResults();
          fetchRecentSearch();
          console.log("type some on mobile")
        }
      });

      document.addEventListener('DOMContentLoaded', function () {
        const tagsInput = document.getElementById('tags');
        const tagsContainer = document.getElementById('tags-container');
        const thumbnailInput = document.getElementById('thumbnail');
        const thumbnailPreview = document.getElementById('thumbnail-preview');
        const addCategoryButton = document.getElementById('add-category-button');
        const categoryModal = document.getElementById('category-modal');
        const cancelCategoryButton = document.getElementById('cancel-category-button');
        const saveCategoryButton = document.getElementById('save-category-button');
        const newCategoryInput = document.getElementById('new-category');
        const tagsHidden = document.getElementById("tags-hidden");
        // Remove any empty strings from the array
        const tagsHiddenArray = tagsHidden.value.split(',').filter(tag => tag !== '');

        // Add the existing tags to the tags container
        tagsHiddenArray.forEach(tag => {
          const tagElement = document.createElement('div');
          tagElement.className = 'tag';
          tagElement.innerHTML = `${tag.trim()} <i class="fas fa-times"></i>`;
          tagsContainer.appendChild(tagElement);
        
          // Add an event listener to the close icon to remove the tag
          tagElement.querySelector('i').addEventListener('click', () => {
              tagElement.parentNode.removeChild(tagElement);
              tagsHidden.value = tagsHidden.value.replace(tag + ',', '');
          });
        });

        tagsInput.addEventListener('keypress', function (e) {
            if (e.key === ' ') {
                e.preventDefault();
                const tagText = tagsInput.value.trim();
                if (tagText) {
                    const tagElement = document.createElement('div');
                    tagElement.className = 'tag';
                    tagElement.innerHTML = `${tagText} <i class="fas fa-times"></i>`;
                    tagsHidden.value += tagText + ',';
                    tagsContainer.appendChild(tagElement);
                    tagsInput.value = '';

                    tagElement.querySelector('i').addEventListener('click', function () {
                        tagsContainer.removeChild(tagElement);
                        tagsHidden.value = tagsHidden.value.replace(tagText + ',', '');
                    });
                }
            }
        });

        thumbnailInput.addEventListener('change', function () {
            const file = thumbnailInput.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    thumbnailPreview.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        });

        addCategoryButton.addEventListener('click', function () {
            categoryModal.classList.remove('hidden');
        });

        cancelCategoryButton.addEventListener('click', function () {
            categoryModal.classList.add('hidden');
            newCategoryInput.value = '';
        });

        //saveCategoryButton.addEventListener('click', function () {
        //    const categoryName = newCategoryInput.value.trim();
        //    if (categoryName) {
        //        // Add the new category to the category list (this is just a placeholder, you should handle this with your backend)
        //        const categorySelect = document.getElementById('category');
        //        const newOption = document.createElement('option');
        //        newOption.value = categoryName;
        //        newOption.text = categoryName;
        //        categorySelect.add(newOption);

        //        categoryModal.classList.add('hidden');
        //        newCategoryInput.value = '';
        //    }
        //});
      });
      
      document.addEventListener('DOMContentLoaded', function () {
        let parentId = null;
        const commentTab = document.getElementById('comment-tab');
        const likeTab = document.getElementById('like-tab');
        const commentIcon = document.getElementById('comment-icon');
        const likeIcon = document.getElementById('like-icon');
        const commentSection = document.getElementById('comment-section');
        const likeSection = document.getElementById('like-section');
        const replyInput = document.getElementById('reply-input');
        const sendIcon = document.getElementById('send-icon');
        const replyInfo = document.getElementById('reply-info');
        const replyInfoText = document.getElementById('reply-info-text');
        const replyInfoClose = document.getElementById('reply-info-close');
       // const replyIcon = document.getElementById('reply-icon');

        commentTab.addEventListener('click', function () {
          commentSection.classList.remove('hidden');
          likeSection.classList.add('hidden');
          commentTab.classList.add('border-2', 'border-blue-500', 'rounded-full', 'bg-blue-500', 'text-white');
          likeTab.classList.remove('border-2', 'border-red-600', 'rounded-full', 'bg-red-600', 'text-white');
        });

        likeTab.addEventListener('click', function () {
          likeSection.classList.remove('hidden');
          commentSection.classList.add('hidden');
          likeTab.classList.add('border-2', 'border-red-600', 'rounded-full', 'bg-red-600', 'text-white');
          commentTab.classList.remove('border-2', 'border-blue-500', 'rounded-full', 'bg-blue-500', 'text-white');
          commentTab.classList.add('text-blue-900');
        });

        replyInput.addEventListener('input', function () {
          if (replyInput.value.trim() !== '') {
            sendIcon.classList.remove('text-blue-900');
            sendIcon.classList.add('text-blue-600');
            sendIcon.classList.add('fas');
            sendIcon.classList.add('hover:text-green-500')
            sendIcon.classList.remove('far');
          } else {
            sendIcon.classList.remove('text-green-500');
            sendIcon.classList.add('text-blue-900');
            sendIcon.classList.remove('hover:text-green-500')
            sendIcon.classList.add('far');
            sendIcon.classList.remove('fas');
          }
        });

        document.querySelectorAll('.reply-button').forEach(button => {
          button.addEventListener('click', function () {
            const commentId = this.getAttribute('data-comment-id');
            const commentAuthor = this.getAttribute('data-comment-author');
            const commentContent = this.getAttribute('data-comment-content');
            parentId = commentId;
            console.log(parentId);
            replyInfoText.innerHTML = `Replying to <strong class="text-blue-600 underline"> @${commentAuthor}:</strong> ${commentContent}`;
            replyInfo.classList.remove('hidden');
            replyInfo.classList.add('flex');
            replyIcon = document.getElementById(`reply-icon-${commentId}`)
            replyIcon.classList.add('fas')
            replyIcon.classList.remove('far');
            replyInput.focus();
          });
        });

        replyInfoClose.addEventListener('click', function () {
          replyInfo.classList.add('hidden');
          if (parentId) {
            replyIcon = document.getElementById(`reply-icon-${parentId}`)
            if (replyIcon){
              replyIcon.classList.add('far');
              replyIcon.classList.remove('fas');
            }
          }
          parentId = null;
          console.log(parentId);
        });

        document.querySelectorAll('.toggle-replies-button').forEach(button => {
          button.addEventListener('click', function () {
            const commentId = this.getAttribute('data-comment-id');
            const repliesSection = document.getElementById(`replies-section-${commentId}`);
            if (repliesSection.style.display === 'none' || !repliesSection.style.display) {
              repliesSection.style.display = 'block';
              this.textContent = 'Hide Replies';
            } else {
              repliesSection.style.display = 'none';
              this.textContent = 'Show Replies';
            }
          });
        });

        // Add event listener for Enter key
        replyInput.addEventListener('keydown', function (event) {
          if (event.key === 'Enter') {
            event.preventDefault(); // Prevent default form submission behavior
            sendIcon.click(); // Trigger the click event on the sendIcon
          }
        });

        sendIcon.addEventListener('click', function() {
          const content = replyInput.value
          if (content) {
            const formData = new FormData();
            formData.append('content', content);
            console.log(parentId);
            if (parentId) {
              formData.append('parent_id', parentId);
            }
            //formData.append('csrfmiddlewaretoken', csrftoken);
            fetch(window.location.href, {
              method: 'POST',
              body: formData,
              headers: {
                'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
              },
            })
           .then(response => {
              if (response.ok) {
                  window.location.reload();
                //console.log('comment successfully')
              } else {
                  console.error('Failed to post comment:', response.statusText);
              }
            })
            .catch(error => {
              console.error('Error posting comment:', error);
           });
         }
        });
      });
    </script>
  </body>
</html>